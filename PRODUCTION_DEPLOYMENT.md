# HeyDoc Production Deployment Guide

## ‚úÖ Database Migrations - First Time Deployment

**YES, migrations will auto-run on deployment!** The `render.yaml` is configured to automatically run migrations:

```bash
startCommand: "python manage.py migrate && python manage.py collectstatic --noinput && gunicorn heydocbackend.wsgi:application"
```

### What happens on first deployment:
1. **Database Creation**: Render creates empty PostgreSQL database
2. **Auto Migration**: `python manage.py migrate` runs automatically
3. **Tables Created**: All Django models become database tables
4. **Static Files**: Frontend assets are collected
5. **Server Start**: Gunicorn starts the Django app

## üöÄ Deployment Steps

### 1. Backend Deployment (Django API)

**Platform**: Render.com (configured in `render.yaml`)

1. **Connect Repository**:
   - Go to [render.com](https://render.com)
   - Connect your GitHub repository
   - Select the `heydocbackend` directory

2. **Set Environment Variables** in Render Dashboard:
   ```bash
   SENDGRID_API_KEY=SG.your-actual-sendgrid-api-key
   FROM_EMAIL=noreply@yourdomain.com
   FRONTEND_URL=https://your-frontend-domain.com
   DEBUG=False
   ```

3. **Deploy**: Render will automatically:
   - Create PostgreSQL database
   - Create Redis instance  
   - Run migrations (creates all tables)
   - Start the API server

### 2. Frontend Deployment (Next.js App)

**Platform**: Vercel (recommended for Next.js)

1. **Connect Repository**:
   - Go to [vercel.com](https://vercel.com)
   - Import your GitHub repository
   - Select the `heydocfrontend` directory

2. **Set Environment Variables** in Vercel:
   ```bash
   NEXT_PUBLIC_API_URL=https://your-backend-url.onrender.com/api
   NEXT_PUBLIC_APP_NAME=HeyDoc
   ```

3. **Deploy**: Vercel will automatically:
   - Build the Next.js app (`npm run build`)
   - Deploy to global CDN
   - Handle SSL certificates

## üìã Pre-Deployment Checklist

### ‚úÖ Backend Ready
- ‚úÖ Migrations created and tested
- ‚úÖ `render.yaml` configured for auto-migration
- ‚úÖ Environment variables documented
- ‚úÖ Static files configuration
- ‚úÖ Database models ready

### ‚úÖ Frontend Ready  
- ‚úÖ Production build successful (`npm run build`)
- ‚úÖ Environment variables externalized
- ‚úÖ API URLs configurable
- ‚úÖ No hardcoded credentials
- ‚úÖ `.env.example` template provided

## üîß Database Setup Details

### What Gets Created Automatically:
1. **User Tables**: Custom user model with patient/doctor roles
2. **Location Tables**: Countries, states, cities, areas
3. **Doctor Tables**: Profiles, specializations, clinics
4. **Appointment Tables**: Bookings, history, statuses
5. **Review Tables**: Patient feedback system
6. **Notification Tables**: System notifications

### Initial Data Population:
After deployment, optionally run:
```bash
python manage.py shell
exec(open('scripts/populate_data.py').read())
```

## üåê Domain Setup

### Production URLs:
- **Frontend**: `https://heydoc.vercel.app` (or custom domain)
- **Backend API**: `https://heydoc-backend.onrender.com/api`

### SSL Certificates:
- **Vercel**: Automatic SSL for frontend
- **Render**: Automatic SSL for backend API

## üîê Security Configuration

### Production Settings:
- `DEBUG=False` (already configured)
- CORS properly configured for your frontend domain
- Secret key auto-generated by Render
- Database credentials managed by platform

### Email Service:
- SendGrid for OTP verification emails
- Rate limiting: 100 emails/day (free tier)
- Verified sender domain required

## üìä Monitoring

### Health Checks:
- **Backend**: `GET /api/health/` (if implemented)
- **Frontend**: Vercel analytics built-in
- **Database**: Render PostgreSQL monitoring

### Logs:
- **Backend**: Render dashboard logs
- **Frontend**: Vercel function logs
- **Email**: SendGrid activity dashboard

## üí∞ Cost Breakdown

### Free Tier (Good for MVP):
- **Vercel**: Free (hobby plan)
- **Render**: Free PostgreSQL + Web service (750 hours/month)
- **SendGrid**: Free (100 emails/day)
- **Total**: $0/month

### Paid Tier (Production Scale):
- **Vercel Pro**: $20/month
- **Render Starter**: $7/month (database) + $7/month (web service)
- **SendGrid**: Free tier sufficient for most apps
- **Total**: ~$34/month

## üöÄ Deployment Command Summary

You just need to:
1. **Push to GitHub**: Code is ready
2. **Connect Render**: Auto-deploys backend + creates DB + runs migrations
3. **Connect Vercel**: Auto-deploys frontend
4. **Set Environment Variables**: In both platforms
5. **Done!**: Your app is live

The migrations will definitely run automatically on first deployment because it's in the `startCommand` in `render.yaml`. No manual database setup required!